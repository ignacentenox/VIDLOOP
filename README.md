# VIDLOOP 2.0 - Sistema Avanzado de Videoloops para Raspberry Pi

Soluci√≥n profesional **TODO-EN-UNO** para reproducci√≥n autom√°tica y continua de videos en pantallas, con **tecnolog√≠a anti-micro-cortes** y configuraci√≥n ultra-optimizada. Ideal para puntos de venta, exhibiciones, ferias, se√±alizaci√≥n digital y aplicaciones de broadcast profesional.

Desarrollado por **Ignacio Manuel Centeno** (Desarrollador de Software), con el aval de **44 Contenidos**.

---

## üéØ ¬øQu√© es VIDLOOP 2.0?

**VIDLOOP 2.0** es la evoluci√≥n completa del sistema de videoloops, que integra en un **√∫nico script instalador** todas las funcionalidades, optimizaciones y correcciones desarrolladas:

- ‚úÖ **Instalaci√≥n completa autom√°tica** (Sistema + Software + Configuraci√≥n)
- ‚úÖ **Tecnolog√≠a anti-micro-cortes** (Buffers 20x, GPU optimizada, CPU overclocking)
- ‚úÖ **Force Display HDMI ultra-agresivo** (Soluci√≥n a pantallas negras)
- ‚úÖ **Configuraci√≥n pi_video_looper optimizada** (video_looper.ini integrado)
- ‚úÖ **Acceso remoto VPN** (ZeroTier autom√°tico)
- ‚úÖ **Inicio autom√°tico con m√∫ltiples respaldos** (systemd + keepalive)
- ‚úÖ **Diagn√≥sticos integrados** (Script de troubleshooting incluido)
- ‚úÖ **Modo optimizaci√≥n de imagen existente** (Para backups con pi_video_looper instalado)

---

## üöÄ Caracter√≠sticas principales

### üé¨ **Reproducci√≥n Ultra-Suave**
- **Anti-micro-cortes**: Buffers de audio/video 20x m√°s grandes
- **GPU Memory**: 256MB asignados para aceleraci√≥n de hardware
- **CPU Overclocking**: 1800MHz para m√°ximo rendimiento
- **Transiciones**: Ultra-suaves de 0.05 segundos entre videos
- **Formatos optimizados**: MP4, H.264, MKV recomendados

### üì∫ **Display Force Ultra-Agresivo**
- **HDMI Keepalive**: Servicio que mantiene la se√±al HDMI activa 24/7
- **Config.txt optimizado**: Par√°metros HDMI forzados para m√°xima compatibilidad
- **Resoluci√≥n fija**: 1920x1080 estable sin fluctuaciones
- **Boot display**: Fuerza la se√±al desde el arranque del sistema

### ‚öôÔ∏è **Configuraci√≥n Avanzada**
- **video_looper.ini**: Integrado con par√°metros anti-micro-cortes
- **omxplayer optimizado**: Par√°metros avanzados para reproducci√≥n fluida
- **Directorio personalizable**: Usa `/home/admin/VIDLOOP44` por defecto
- **M√∫ltiples ubicaciones**: Configuraci√≥n distribuida autom√°ticamente

### üîÑ **Inicio Autom√°tico Robusto**
- **Servicio systemd**: Con prioridad m√°xima
- **HDMI keepalive**: Servicio independiente para mantener display
- **Reinicio autom√°tico**: Si el video falla, se reinicia autom√°ticamente
- **Detecci√≥n inteligente**: Funciona con instalaciones existentes

### üåê **Acceso Remoto Profesional**
- **ZeroTier VPN**: Acceso seguro desde cualquier lugar
- **SSH optimizado**: Con configuraci√≥n de seguridad
- **Logs centralizados**: Diagn√≥stico remoto completo
- **Script de diagn√≥stico**: Troubleshooting autom√°tico incluido

---

## üìã Requisitos del sistema

- **Raspberry Pi**: 3B+, 4B, o superior (recomendado: 4B con 4GB RAM)
- **Sistema operativo**: Raspberry Pi OS (32-bit o 64-bit)
- **Tarjeta SD**: M√≠nimo 16GB, recomendado 32GB+ (Clase 10)
- **Alimentaci√≥n**: Fuente oficial de 5V/3A m√≠nimo
- **Conectividad**: Puerto HDMI + Internet para instalaci√≥n inicial

---

## üîß Instalaci√≥n paso a paso

Ofrecemos una imagen con `VIDLOOP` ya instalado: PROXIMAMENTE 

#### 1. **Copiar script a la Raspberry Pi**

# Clonar repositorio completo
git clone https://github.com/ignacentenox/VIDLOOP.git
cd VIDLOOP

#### 2. **Ejecutar optimizaci√≥n**

```bash
# Dar permisos de ejecuci√≥n
chmod +x vidloop-definitivo.sh

# Ejecutar instalaci√≥n completa (como sudo)
sudo ./vidloop-definitivo.sh
```

El script **detecta autom√°ticamente** si hay una instalaci√≥n existente y aplica solo las optimizaciones necesarias.

---

## üé¨ Proceso de instalaci√≥n autom√°tico

El script realiza **autom√°ticamente**:

### **Para instalaci√≥n completa:**
- ‚úÖ **Detecci√≥n de usuario y sistema**
- ‚úÖ **Actualizaci√≥n completa del sistema**
- ‚úÖ **Instalaci√≥n de todas las dependencias**
- ‚úÖ **Clonado e instalaci√≥n de pi_video_looper**
- ‚úÖ **Configuraci√≥n de GPU y CPU** (256MB GPU, 1800MHz CPU)
- ‚úÖ **Optimizaci√≥n de config.txt**
- ‚úÖ **Configuraci√≥n anti-micro-cortes** (video_looper.ini optimizado)
- ‚úÖ **Setup HDMI force ultra-agresivo**
- ‚úÖ **Instalaci√≥n y configuraci√≥n de ZeroTier VPN**
- ‚úÖ **Creaci√≥n de servicios systemd** (inicio autom√°tico)
- ‚úÖ **Scripts de diagn√≥stico y utilidades**
- ‚úÖ **Configuraci√≥n de SSH seguro**

### **Para optimizaci√≥n de imagen existente:**
- ‚úÖ **Respeta instalaci√≥n existente** de pi_video_looper
- ‚úÖ **Aplica optimizaciones anti-micro-cortes**
- ‚úÖ **Reinstala ZeroTier limpiamente**
- ‚úÖ **Configura HDMI ultra-agresivo**
- ‚úÖ **Optimiza sistema operativo**
- ‚úÖ **Mantiene compatibilidad** con configuraci√≥n original

---

## üé¨ Uso del sistema

### **Agregar videos**
1. **Crear/verificar directorio de videos:**
   ```bash
   /home/admin/videos
   ```

2. **Subir videos** (formatos recomendados):
   - ‚úÖ **MP4** (H.264) - **RECOMENDADO**
   - ‚úÖ **H.264** puro - **√ìPTIMO**
   - ‚úÖ **MKV** - **BUENO**
   - ‚ö†Ô∏è AVI, WMV, FLV (pueden causar micro-cortes)

3. **Los videos se reproducen autom√°ticamente** al arrancar la RPi

### **Comandos √∫tiles**

#### **Para instalaci√≥n completa:**
```bash
# Ver estado del servicio
sudo systemctl status video_looper

# Reiniciar reproducci√≥n
sudo systemctl restart video_looper

# Ver logs en tiempo real
sudo journalctl -u video_looper -f

# Ejecutar diagn√≥stico completo
sudo /usr/local/bin/vidloop-definitivo-diagnostic.sh
```

#### **Para imagen existente optimizada:**
```bash
# Usar instalaci√≥n original
sudo systemctl restart video_looper

# Usar script optimizado (respaldo)
sudo /usr/local/bin/vidloop-definitivo.sh

# Ver logs optimizados
tail -f /var/log/vidloop-definitivo.log

# Diagn√≥stico completo
sudo /usr/local/bin/vidloop-definitivo-diagnostic.sh
```

---

## üåê Configuraci√≥n VPN (ZeroTier)

### **Durante la instalaci√≥n:**
El script pregunta si deseas configurar ZeroTier y solicita el Network ID.

### **Configuraci√≥n manual posterior:**
```bash
# Unir a tu red ZeroTier
sudo zerotier-cli join TU_NETWORK_ID

# Ver redes conectadas
sudo zerotier-cli listnetworks

# Ver informaci√≥n del nodo
sudo zerotier-cli info
```

### **Autorizar en panel web:**
1. Ir a [ZeroTier Central](https://my.zerotier.com/)
2. Autorizar la nueva Raspberry Pi  
3. Anotar la IP asignada

### **Acceso SSH remoto:**

## üîß Configuraci√≥n avanzada

### **Personalizar video_looper.ini**

#### **Para instalaci√≥n completa:**
Archivo en: `/opt/video_looper/video_looper.ini`

#### **Para imagen existente:**
El script busca y optimiza **todos** los archivos `video_looper.ini` encontrados.

**Par√°metros clave anti-micro-cortes:**
```ini
# Buffers aumentados 20x
omxplayer_extra_args = --audio_queue 20 --video_queue 20 --fps 30

# Transici√≥n ultra-suave
wait_time = 0.05

# Directorio optimizado
directory_path = /home/admin/VIDLOOP44

# Hardware acceleration
hw_accel = true
```

### **Modificar directorio de videos**
```bash
# Editar configuraci√≥n principal
sudo nano /opt/video_looper/video_looper.ini

# Cambiar ruta:
directory_path = /tu/nueva/ruta

# Reiniciar servicio
sudo systemctl restart video_looper
```

---

## üõ†Ô∏è Troubleshooting

### **Script de diagn√≥stico autom√°tico**
```bash
# Ejecutar diagn√≥stico completo (detecta modo autom√°ticamente)
sudo /usr/local/bin/vidloop-definitivo-diagnostic.sh
```

### **Problemas comunes y soluciones**

**‚ùå Pantalla negra al arrancar:**
```bash
# Forzar HDMI manualmente
sudo tvservice -p
sudo tvservice --explicit="CEA 16 HDMI"

# Verificar servicio HDMI keepalive
sudo systemctl status hdmi-keepalive
```

**‚ùå Videos con micro-cortes:**
```bash
# Verificar configuraci√≥n anti-micro-cortes
grep -E "(audio_queue|video_queue)" /opt/video_looper/video_looper.ini

# Debe mostrar: audio_queue 20, video_queue 20
```

**‚ùå Servicio no inicia:**
```bash
# Para instalaci√≥n completa
sudo journalctl -u video_looper -n 50

# Para imagen existente
sudo systemctl restart video_looper
tail -f /var/log/vidloop-definitivo.log
```

**‚ùå No encuentra videos:**
```bash
# Verificar directorio y permisos
ls -la /home/admin/VIDLOOP44/
sudo chown -R admin:admin /home/admin/VIDLOOP44/
```

**‚ùå Problemas con imagen existente:**
```bash
# Re-ejecutar optimizaci√≥n
sudo ./vidloop-definitivo.sh

# Verificar instalaci√≥n existente detectada
sudo /usr/local/bin/vidloop-definitivo-diagnostic.sh
```

---

## üìä Especificaciones t√©cnicas

### **Optimizaciones de hardware**
- **GPU Memory**: 256MB (√≥ptimo para video HD)
- **CPU Frequency**: 1800MHz (overclock estable)
- **GPU Frequency**: 500MHz (aceleraci√≥n m√°xima)
- **Memory Split**: 256MB para GPU
- **I/O Scheduler**: Deadline (√≥ptimo para video)

### **Configuraci√≥n de software**
- **Video Player**: omxplayer (hardware-accelerated)
- **Audio Buffers**: 20x m√°s grandes (anti-micro-cortes)
- **Video Buffers**: 20x m√°s grandes (reproducci√≥n fluida)
- **Frame Rate**: 30fps fijo (estabilidad)
- **Priority**: Nice -20 (m√°xima prioridad CPU)

### **Servicios del sistema**

#### **Instalaci√≥n completa:**
- `video_looper.service` - Reproductor principal
- `hdmi-keepalive.service` - Mantiene se√±al HDMI
- `zerotier-one.service` - VPN para acceso remoto

#### **Imagen existente optimizada:**
- Mantiene servicios originales
- A√±ade `hdmi-keepalive.service`
- Script optimizado como respaldo

---

## üìà Ventajas VIDLOOP 2.0

| Caracter√≠stica | VIDLOOP v1.0 | VIDLOOP 2.0 |
|----------------|--------------|-------------|
| **Instalaci√≥n** | Solo nueva | ‚úÖ Nueva + Optimizaci√≥n de existente |
| **Detecci√≥n autom√°tica** | Manual | ‚úÖ Detecta instalaciones existentes |
| **Anti-micro-cortes** | B√°sico | ‚úÖ Buffers 20x + par√°metros avanzados |
| **Display Force** | Est√°ndar | ‚úÖ Ultra-agresivo + keepalive |
| **ZeroTier** | Configuraci√≥n manual | ‚úÖ Reinstalaci√≥n limpia autom√°tica |
| **Compatibilidad** | Solo nueva instalaci√≥n | ‚úÖ Respeta configuraciones existentes |
| **Diagn√≥sticos** | B√°sico | ‚úÖ Detecta modo y adapta diagn√≥stico |
| **Flexibilidad** | Un solo modo | ‚úÖ Dos modos: completo + optimizaci√≥n |

---

## üí° Casos de uso recomendados

### **üè™ Retail y puntos de venta**
- Promociones y ofertas en loop
- Informaci√≥n de productos
- Se√±alizaci√≥n digital interstore

### **üé™ Ferias y eventos**
- Presentaciones corporativas
- Demos de productos
- Informaci√≥n institucional

### **üì∫ Broadcast y televisi√≥n**
- Separadores de programaci√≥n
- Publicidades en loop
- Contenido de relleno

### **üè¢ Oficinas corporativas**
- Comunicaci√≥n interna
- KPIs y m√©tricas en tiempo real
- Informaci√≥n para visitantes

### **üîß Optimizaci√≥n de instalaciones existentes**
- Mejora de sistemas ya implementados
- Actualizaci√≥n sin reinstalaci√≥n completa
- Mantenimiento de configuraciones personalizadas

---

## üîÑ Actualizaciones y mantenimiento

### **Actualizar VIDLOOP 2.0**
```bash
# Descargar nueva versi√≥n
curl -O https://raw.githubusercontent.com/ignacentenox/VIDLOOP/main/RASPBERRY-PAGE/vidloop-definitivo.sh
chmod +x vidloop-definitivo.sh

# Ejecutar (detecta autom√°ticamente el modo)
sudo ./vidloop-definitivo.sh
```

### **Mantenimiento peri√≥dico**
```bash
# Limpiar logs (mensual)
sudo journalctl --vacuum-time=30d

# Verificar salud del sistema
sudo /usr/local/bin/vidloop-definitivo-diagnostic.sh

# Actualizar sistema base (trimestral)
sudo apt update && sudo apt upgrade -y

# Verificar temperatura (importante con overclock)
vcgencmd measure_temp
```

---

## üìÅ Estructura del proyecto

```
VIDLOOP/
‚îÇ   ‚îú‚îÄ‚îÄ vidloop-definitivo.sh      # Script principal VIDLOOP 2.0
‚îÇ   ‚îú‚îÄ‚îÄ video_looper.ini           # Configuraci√≥n optimizada
‚îÇ   ‚îî‚îÄ‚îÄ README.md                  # Este archivo
‚îú‚îÄ‚îÄ assets/
‚îÇ   ‚îî‚îÄ‚îÄ configuraciones/           # Archivos de configuraci√≥n adicionales
‚îî‚îÄ‚îÄ docs/
    ‚îî‚îÄ‚îÄ troubleshooting.md         # Gu√≠a de resoluci√≥n de problemas
```

---

## üìû Soporte t√©cnico profesional

### **Desarrollado por:**
**Ignacio Manuel Centeno**  
üîß Desarrollador de Software  
üìß [ignacenteno46@gmail.com](mailto:ignacenteno46@gmail.com)  
üåê Especialista en Raspberry Pi y sistemas embebidos

### **Avalado por:**
**44 Contenidos**  
üé¨ Soluciones audiovisuales y digitales profesionales  
üì∫ Especialistas en broadcast digital

### **Soporte incluido:**
- ‚úÖ **Instalaci√≥n remota** v√≠a ZeroTier VPN
- ‚úÖ **Configuraci√≥n personalizada** seg√∫n necesidades
- ‚úÖ **Optimizaci√≥n de sistemas existentes**
- ‚úÖ **Troubleshooting** y resoluci√≥n de problemas
- ‚úÖ **Actualizaciones** y mejoras continuas
- ‚úÖ **Documentaci√≥n t√©cnica** completa
- ‚úÖ **Soporte para migraciones** desde v1.0

---

## üöÄ ¬øListo para la nueva generaci√≥n de videoloops?

**VIDLOOP 2.0** es la soluci√≥n m√°s completa y robusta del mercado para Raspberry Pi, dise√±ada para entornos profesionales que requieren:

- ‚ö° **M√°xima estabilidad** en cualquier escenario
- üéØ **Cero micro-cortes** garantizado
- üîß **F√°cil mantenimiento** y actualizaci√≥n
- üåê **Acceso remoto seguro**
- üí™ **Soporte t√©cnico profesional**
- üîÑ **Compatibilidad** con sistemas existentes
- üìà **Migraci√≥n sin p√©rdida** de configuraciones

### **Novedades en VIDLOOP 2.0:**
- üÜï **Modo optimizaci√≥n** para im√°genes existentes
- üÜï **Detecci√≥n autom√°tica** de instalaciones
- üÜï **ZeroTier reinstalaci√≥n limpia**
- üÜï **Diagn√≥sticos adaptativos**
- üÜï **Mayor compatibilidad** con diferentes configuraciones

### **¬°Consultanos para implementaciones a medida!**

**¬øNecesitas migrar sistemas existentes? ¬øM√∫ltiples pantallas? ¬øConfiguraci√≥n corporativa? ¬øIntegraci√≥n con sistemas existentes?**

Contactanos para soluciones y descuentos por volumen.

---

## üìÑ Licencia

Este proyecto est√° bajo la licencia MIT. Ver el archivo `LICENSE` para m√°s detalles.

---

## ü§ù Contribuciones

Las contribuciones son bienvenidas. Por favor:

1. Fork el proyecto
2. Crea una rama para tu feature (`git checkout -b feature/AmazingFeature`)
3. Commit tus cambios (`git commit -m 'Add some AmazingFeature'`)
4. Push a la rama (`git push origin feature/AmazingFeature`)
5. Abre un Pull Request

---

## ‚≠ê Agradecimientos

- **Adafruit** por pi_video_looper
- **Raspberry Pi Foundation** por el ecosistema RPi
- **ZeroTier** por la soluci√≥n VPN
- **Comunidad Open Source** por las herramientas utilizadas

---

*VIDLOOP 2.0 - La evoluci√≥n inteligente de los sistemas de videoloops para Raspberry Pi* üéØ  
*Compatible con instalaciones existentes ‚Ä¢ Optimizaci√≥n autom√°tica ‚Ä¢ Soporte profesional*

[![GitHub stars](https://img.shields.io/github/stars/ignacentenox/VIDLOOP.svg)](https://github.com/ignacentenox/VIDLOOP/stargazers)
[![GitHub forks](https://img.shields.io/github/forks/ignacentenox/VIDLOOP.svg)](https://github.com/ignacentenox/VIDLOOP/network)
[![GitHub issues](https://img.shields.io/github/issues/ignacentenox/VIDLOOP.svg)](https://github.com/ignacentenox/VIDLOOP/issues)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
